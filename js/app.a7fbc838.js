(function(e){function t(t){for(var s,i,o=t[0],l=t[1],c=t[2],u=0,m=[];u<o.length;u++)i=o[u],n[i]&&m.push(n[i][0]),n[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},n={app:0},r=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/new-calendar/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0381":function(e,t,a){},"0f16":function(e,t,a){"use strict";var s=a("77b3"),n=a.n(s);n.a},"1c6c":function(e,t,a){"use strict";var s=a("d700"),n=a.n(s);n.a},"3bb0":function(e,t,a){e.exports=a.p+"img/avatar-default.adf476bc.png"},"488a":function(e,t,a){"use strict";var s=a("6add"),n=a.n(s);n.a},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),n=(a("4b3c"),a("340b")),r=a("9f3f"),i=a.n(r),o=a("7bb1"),l=a("ecee"),c=a("c074"),d=a("b702"),u=a("ad3d"),m=a("3049"),v=a.n(m),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calendar-app"},[a("modal"),a("selectors"),a("control-panel"),a("events-grid")],1)},p=[],f=a("be94"),b=a("2f62"),C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpened,expression:"isOpened"}],staticClass:"enroll-modal-box"},[a("div",{staticClass:"enroll-modal",class:e.data.themeClass,style:{top:e.top+"px"}},[a("font-awesome-icon",{staticClass:"modal-close",attrs:{icon:"times"},on:{click:e.closeModal}}),a("div",{staticClass:"modal-header modal-block"},[e.data.cover?a("img",{staticClass:"modal-header-cover",attrs:{src:e.data.cover}}):e._e(),a("div",{staticClass:"modal-header-info"},[a("div",{staticClass:"modal-header-title"},[e._v("\n          "+e._s(e.data.title)+"\n        ")]),a("div",{staticClass:"modal-header-extra"},[e.data.age?a("span",{staticClass:"header-extra-item age"},[a("font-awesome-icon",{staticClass:"extra-item-icon",attrs:{icon:"child"}}),e._v("\n            "+e._s(e.data.age)+"\n          ")],1):e._e(),e.data.duration?a("span",{staticClass:"header-extra-item duration"},[a("font-awesome-icon",{staticClass:"extra-item-icon",attrs:{icon:"hourglass-half"}}),e._v("\n            "+e._s(e.data.duration)+" мин\n          ")],1):e._e()])])]),a("div",{staticClass:"enroll-switcher",class:{"opened-enroll":e.isFormOpened}},[a("div",{staticClass:"pre-enroll"},[a("div",{staticClass:"event-info"},[a("div",{staticClass:"event-info-item date"},[e._v("\n            "+e._s(e.data.date)+"\n          ")]),a("div",{staticClass:"event-info-item address"},[e._v("\n            "+e._s(e.data.address)+"\n          ")]),a("div",{staticClass:"event-info-item time"},[e._v("\n            "+e._s(e.data.timing)+"\n          ")])]),a("button",{staticClass:"modal-button show-form",on:{click:e.showForm}},[e._v("\n          Запись\n        ")])]),a("div",{staticClass:"modal-enroll modal-block"},[a("div",{staticClass:"modal-enroll-form"},[a("labeled-input",{staticClass:"enroll-field-wrap",attrs:{"is-active":e.isNameActive,label:"Имя"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.enrollForm.name,expression:"enrollForm.name"}],staticClass:"enroll-input enroll-input-field",attrs:{type:"text",required:""},domProps:{value:e.enrollForm.name},on:{focus:function(t){e.enrollFormFocus.name=!0},blur:function(t){e.enrollFormFocus.name=!1},input:function(t){t.target.composing||e.$set(e.enrollForm,"name",t.target.value)}}})]),a("labeled-input",{staticClass:"enroll-field-wrap",attrs:{"is-active":e.isPhoneActive,label:"Телефон"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.enrollForm.phone,expression:"enrollForm.phone"},{name:"validate",rawName:"v-validate",value:{required:!0,regex:/^\+7[0-9]{10}}$/},expression:"{ required: true, regex: /^\\+7[0-9]{10}}$/ }"}],ref:"phone",staticClass:"enroll-input enroll-input-field",attrs:{"data-vv-as":"Номер телефона",type:"tel",title:"+79996662233"},domProps:{value:e.enrollForm.phone},on:{focus:function(t){e.enrollFormFocus.phone=!0},blur:function(t){e.enrollFormFocus.phone=!1},input:function(t){t.target.composing||e.$set(e.enrollForm,"phone",t.target.value)}}})]),a("labeled-input",{staticClass:"enroll-field-wrap",attrs:{"is-active":e.isEmailActive,label:"Email"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.enrollForm.email,expression:"enrollForm.email"},{name:"validate",rawName:"v-validate"}],staticClass:"enroll-input enroll-input-field",attrs:{"data-vv-as":"Email",type:"email"},domProps:{value:e.enrollForm.email},on:{focus:function(t){e.enrollFormFocus.email=!0},blur:function(t){e.enrollFormFocus.email=!1},input:function(t){t.target.composing||e.$set(e.enrollForm,"email",t.target.value)}}})]),a("button",{staticClass:"modal-button enroll-input submit-enroll",on:{click:e.sendEnrollRequest}},[e._v("\n            Записаться\n          ")])],1),e._m(0),e._m(1)])]),e.tabs.length?a("div",{staticClass:"modal-about modal-block"},[a("div",{staticClass:"modal-about-tabs"},e._l(e.tabs,function(t){return a("div",{key:t.name,staticClass:"modal-about-tab",class:{current:e.isCurrentTab(t.tab)&&e.tabs.length>1},style:{cursor:e.tabs.length>1?"pointer":"default"},on:{click:function(a){e.currentTab=t.tab}}},[e._v("\n          "+e._s(t.name)+"\n        ")])}),0),e._l(e.tabs,function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentTab(t.tab),expression:"isCurrentTab(tab.tab)"}],key:t.name,staticClass:"modal-about-tab-body"},[e._v("\n        "+e._s(t.content)+"\n      ")])})],2):e._e(),e.data.teacher?a("div",{staticClass:"modal-teacher modal-block"},[a("img",{staticClass:"modal-teacher-photo",attrs:{src:e.data.teacher.avatar}}),a("div",{staticClass:"modal-teacher-info"},[a("span",{staticClass:"modal-teacher-heading"},[e._v("Преподаватель")]),a("br"),a("span",{staticClass:"modal-teacher-name"},[e._v(e._s(e.data.teacher.name))])])]):e._e()],1)])},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"enroll-success enroll-status"},[e._v("\n          Спасибо за заявку!\n          "),a("br"),e._v("Мы свяжемся с вами в ближайшее время.\n        ")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"enroll-fail enroll-status"},[e._v("\n          К сожалению, что-то пошло не так и мы не смогли принять вашу\n          заявку.\n          "),a("br"),e._v("Вы можете связаться с нами по телефону +7(495) 255-57-10\n        ")])}],_=(a("ac6a"),a("28a5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"labeled-input",class:{active:e.isActive}},[a("label",{staticClass:"label"},[e._v("\n    "+e._s(e.label)+"\n  ")]),e._t("default")],2)}),k=[],w={props:{isActive:{type:Boolean,default:!1},label:{type:String,default:""}}},y=w,O=(a("8462"),a("2877")),D=Object(O["a"])(y,_,k,!1,null,"1732da51",null),j=D.exports;function x(e){return e=e.split(" "),{viewportWidth:e[0],viewportHeight:e[1],top:e[2],left:e[3],bottom:e[4],right:e[5]}}var S={components:{labeledInput:j},data(){return{isFormOpened:!1,currentTab:null,enrollForm:{name:"",email:"",phone:""},enrollFormFocus:{name:!1,email:!1,phone:!1},top:0}},computed:Object(f["a"])({},Object(b["e"])({isOpened:"isModalOpened",data:"modalData"}),{tabs(){return[{tab:"description",name:"О занятии",content:this.data.description},{tab:"teacher",name:"О преподавателе",content:this.data.teacher&&this.data.teacher.bio},{tab:"photo",name:"Фото",content:this.data.photo},{tab:"video",name:"Видео",content:this.data.video}].filter(e=>e.content)},initialTab(){return this.tabs.length?this.tabs[0].tab:null},formMetaData(){return{lessonId:this.data.id,regSourceId:2}},isNameActive(){return Boolean(this.enrollForm.name||this.enrollFormFocus.name)},isEmailActive(){return Boolean(this.enrollForm.email||this.enrollFormFocus.email)},isPhoneActive(){return Boolean(this.enrollForm.phone||this.enrollFormFocus.phone)}}),mounted(){this.$frame.onMessage("viewport-iframe-position",e=>this.repositeModal(e))},methods:Object(f["a"])({},Object(b["d"])(["setModalStatus"]),{closeModal(){this.setModalStatus({isOpened:!1}),this.isFormOpened=!1},showForm(){this.isFormOpened=!0},isCurrentTab(e){return(this.currentTab||this.initialTab)===e},sendEnrollRequest(){const e=new FormData,t=Object.entries(Object.assign({},this.formMetaData,this.enrollForm));t.forEach(t=>e.append(...t)),fetch("https://db2.gekkon-club.ru/api/add-lead",{method:"POST",body:e}).then(e=>{e.ok?console.log("Каеф"):console.log("Плоха")})},repositeModal(e){const t=x(e),a=t.viewportWidth<=480,s=a?50:100,n=t.top>0?s:-t.top+s;this.isOpened||(this.top=n)}})},F=S,W=(a("488a"),Object(O["a"])(F,C,g,!1,null,"1d17a632",null)),M=W.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"selectors"},e._l(e.selectors,function(e){return a("selector",{key:e.name,attrs:{selections:e.selections,category:e.category,label:e.name}})}),1)},T=[],A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:e.blur,expression:"blur"}],staticClass:"selector",class:{filled:e.isFilled,active:e.isActive,opened:e.opened}},[a("labeled-input",{attrs:{label:e.label,"is-active":e.isActive}},[a("div",{staticClass:"main",on:{click:function(t){e.opened=!e.opened}}},[e.selected.length?a("div",{staticClass:"current-selection"},[e._v("\n        "+e._s(e.selected.map(function(e){return e.title}).join(", "))+"\n      ")]):e.opened&&!e.isFilled?a("div",{staticClass:"tip"},[e._v("\n        Выберите фильтр\n      ")]):e._e(),a("div",{staticClass:"control"},[e.selected.length?a("font-awesome-icon",{attrs:{icon:"times-circle"},on:{click:function(t){return t.stopPropagation(),e.clearSelections(t)}}}):e._e(),a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"chevron-down"}})],1)])]),a("div",{staticClass:"dropdown-wrapper"},[a("transition",{attrs:{name:"dropdown"}},[e.opened?a("div",{staticClass:"dropdown"},e._l(e.selections,function(t){return a("label",{key:t.title,staticClass:"item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selected)?e._i(e.selected,t)>-1:e.selected},on:{change:function(a){var s=e.selected,n=a.target,r=!!n.checked;if(Array.isArray(s)){var i=t,o=e._i(s,i);n.checked?o<0&&(e.selected=s.concat([i])):o>-1&&(e.selected=s.slice(0,o).concat(s.slice(o+1)))}else e.selected=r}}}),a("div",{staticClass:"selection"},[e._v(e._s(t.title))]),a("div",{staticClass:"checkbox"},[e.some(e.selected,t)?a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"check"}}):e._e()],1)])}),0):e._e()])],1)],1)},L=[],I=a("c7db"),E=a("9429"),P={components:{labeledInput:j},mixins:[I["mixin"]],props:{selections:{type:Array,default:()=>[]},category:{type:String,default:""},label:{type:String,default:""}},data(){return{opened:!1}},computed:{selected:{get(){return this.$store.state.filters[this.category]},set(e){this.updateFilter({category:this.category,selection:e})}},areAllSelected(){return this.selected.length===this.selections.length},isActive(){return Boolean(this.selected.length||this.opened)},isFilled(){return this.selected.length}},methods:Object(f["a"])({},Object(b["d"])(["updateFilter"]),{some:E["a"],blur(){this.opened=!1},clearSelections(){this.selected=[]}})},N=P,Y=(a("96f9"),Object(O["a"])(N,A,L,!1,null,"5a0343e8",null)),q=Y.exports,H={components:{selector:q},computed:Object(f["a"])({},Object(b["c"])(["selectors"]))},B=H,J=(a("b4d8"),Object(O["a"])(B,$,T,!1,null,"ca08c796",null)),R=J.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"panel"},[a("div",{staticClass:"panel-element"},[a("div",{staticClass:"switchers"},[a("button",{staticClass:"button today-switcher",on:{click:e.switchToCurrentWeek}},[e._v("\n        Сегодня\n      ")]),a("font-awesome-icon",{staticClass:"week-switcher",attrs:{icon:"caret-left"},on:{click:e.switchToPreviousWeek}}),a("button",{staticClass:"current-month button",on:{click:e.switchDatepickerShow}},[a("font-awesome-icon",{attrs:{icon:["far","calendar-alt"]}}),e._v("\n        "+e._s(e.currentMonth)+"\n      ")],1),a("font-awesome-icon",{staticClass:"week-switcher",attrs:{icon:"caret-right"},on:{click:e.switchToNextWeek}})],1),a("div",{staticClass:"panel-element datepicker",attrs:{id:"datepicker"}},[e.showDatepicker?a("datepicker",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:e.switchDatepickerShow,expression:"switchDatepickerShow"}],attrs:{"monday-first":"",language:e.ru,inline:""},on:{selected:e.handleDatePick}}):e._e()],1)]),a("div",{staticClass:"panel-element week-days-switchers"},e._l(e.currentWeekDays,function(t,s){return a("button",{key:t.getDay(),staticClass:"button week-day-switcher",class:{current:e.$store.state.soloColumnIndex===s},on:{click:function(t){return e.setSoloColumnIndex({index:s})}}},[a("div",{staticClass:"day-name"},[e._v("\n        "+e._s(e._f("formatDate")(t,"dd"))+"\n      ")]),a("div",{staticClass:"day-date"},[e._v("\n        "+e._s(e._f("formatDate")(t,"D"))+"\n      ")])])}),0),e._m(0)])},G=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"panel-element color-legend"},[a("span",{staticClass:"color-legend-element preschoolars"},[e._v("Дошкольники")]),a("span",{staticClass:"color-legend-element grades1-2"},[e._v("1-2 класс")]),a("span",{staticClass:"color-legend-element grades3-4"},[e._v("3-4 класс")]),a("span",{staticClass:"color-legend-element grades5-11"},[e._v("5-11 класс")])])}],z=a("fa33"),K=a("ee9b"),Q={components:{Datepicker:z["a"]},mixins:[I["mixin"]],data(){return{ru:K["a"],showDatepicker:!1}},computed:Object(f["a"])({},Object(b["c"])(["currentMonth","currentWeekDays"])),methods:Object(f["a"])({},Object(b["d"])(["setSoloColumnIndex","setWeekStart"]),Object(b["b"])(["switchToNextWeek","switchToPreviousWeek","switchToCurrentWeek"]),{switchDatepickerShow(){this.showDatepicker=!this.showDatepicker},handleDatePick(e){this.setWeekStart({startDay:Object(n["startOfWeek"])(e,{weekStartsOn:1})}),this.setSoloColumnIndex({index:Object(n["getISODay"])(e)-1})}})},V=Q,X=(a("6eeb"),a("f795"),Object(O["a"])(V,U,G,!1,null,"c7f5d864",null)),Z=X.exports,ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"events-grid"},e._l(e.currentWeekDays,function(t,s){return a("div",{key:s,staticClass:"col animated faster",class:{slideInLeft:e.$store.state.soloColumnIndex===s,solo:e.$store.state.soloColumnIndex===s}},[a("div",{staticClass:"col-head",class:{"current-day":e.isToday(t)}},[a("div",{staticClass:"day-date"},[e._v("\n          "+e._s(e._f("formatDate")(t,"D"))+"\n        ")]),a("div",{staticClass:"day-name"},[e._v("\n          "+e._s(e._f("formatDate")(t,"dd"))+"\n        ")])]),e.$store.state.isDataLoaded?[a("transition-group",{staticClass:"tr-wrapper",attrs:{tag:"div",appear:"","enter-active-class":"animated fadeInUp"}},[e.weekSchedule[s].length?e._e():a("div",{key:"free-day",staticClass:"free-day-wrapper"},[a("div",{staticClass:"free-day"},[e._v("\n              Нет занятий\n            ")])]),e._l(e.weekSchedule[s],function(e){return a("event-card",{key:e.id,attrs:{event:e}})})],2)]:e._e()],2)}),0),e.$store.state.isDataLoaded?e._e():a("div",{staticClass:"preloader"},[e._m(0)])])},te=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lds-roller"},[a("div"),a("div"),a("div"),a("div"),a("div"),a("div"),a("div"),a("div")])}],ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card",class:e.themeClass,on:{click:e.toggleModal}},[a("div",{staticClass:"header"},[e.isClosed?[e.event.cover?a("img",{staticClass:"cover",attrs:{src:e.event.cover}}):e._e(),a("div",{staticClass:"header-description"},[a("div",{staticClass:"header-title break-word"},[e._v("\n          "+e._s(e.title)+"\n        ")]),a("div",{staticClass:"header-description-info"},[e.age?a("div",{staticClass:"age"},[a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"child"}}),e._v("\n            "+e._s(e.age)+"\n          ")],1):e._e(),e.duration?a("div",[a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"hourglass-half"}}),e._v("\n            "+e._s(e.duration)+" мин.\n          ")],1):e._e()])])]:[e._m(0),a("div",{staticClass:"future-event-start-date"}),a("div",{staticClass:"future-event-label"})]],2),a("div",{staticClass:"description"},[a("div",{staticClass:"description-item"},[a("font-awesome-icon",{staticClass:"icon",attrs:{icon:["far","clock"]}}),e._v("\n      "+e._s(e.timing)+"\n    ")],1),a("div",{staticClass:"description-item break-word"},[a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"map-marker-alt"}}),e._v("\n      "+e._s(e.address)+"\n    ")],1),e.event.teacher&&e.event.teacher.name?a("div",{staticClass:"description-item"},[a("font-awesome-icon",{staticClass:"icon",attrs:{icon:"chalkboard-teacher"}}),e._v("\n      "+e._s(e.event.teacher.name)+"\n    ")],1):e._e()])])},se=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"future-event-cover"},[a("div",{staticClass:"lds-ripple"},[a("div"),a("div")])])}],ne=a("ec41"),re=a("fc72");const ie=a("3bb0");var oe={props:{event:{type:Object,default:()=>({})}},computed:{duration(){return this.event.baseLesson.duration},timing(){const e=new Date(this.event.startDate),t=Object(n["addMinutes"])(e,this.event.baseLesson.duration),a=Object(n["format"])(e,"HH:mm"),s=Object(n["isEqual"])(e,t)?"":` - ${Object(n["format"])(t,"HH:mm")}`;return a+s},age(){let e,t,a;const s=this.event.baseLesson;return s.minClass||s.minAge?(s.minClass?(e=s.minClass,t=s.maxClass,a=" класс"):(e=s.minAge,t=s.maxAge,a=" лет"),`${e}${e!==t?`-${t}`:""} ${a}`):null},isClosed(){return!0},themeClass(){const e=this.event.baseLesson;return null===e.minClass&&null===e.minAge?"no-age":e.minAge&&!e.minClass?"preschoolars":e.minClass<=2?"grades1-2":e.minClass<=4?"grades3-4":"grades5-11"},title(){return this.event.baseLesson.name.trim()},address(){return this.$store.state.maps.address[Object(ne["a"])(this.event,this.$store.state.paths.address)]},date(){return Object(n["format"])(new Date(this.event.startDate),"D MMMM YYYY, dddd",{locale:i.a})},room(){return this.event.room.name},teacher(){let e=this.event.teacher;return e?(e=Object(f["a"])({},e),Object(re["a"])(e,"avatar",e=>e||ie)):null},extractedData(){return{timing:this.timing,age:this.age,themeClass:this.themeClass,title:this.title,address:this.address,date:this.date,cover:this.cover,room:this.room,teacher:this.teacher,id:this.event.id,baseId:this.event.baseLesson.id,duration:this.event.baseLesson.duration,description:this.event.description}}},methods:Object(f["a"])({},Object(b["d"])(["setModalStatus","setModalData"]),{toggleModal(){this.setModalStatus({isOpened:!0}),this.setModalData({data:Object(f["a"])({},this.extractedData)})}})},le=oe,ce=(a("1c6c"),Object(O["a"])(le,ae,se,!1,null,"71645094",null)),de=ce.exports,ue={name:"EventsGrid",components:{eventCard:de},data(){return{today:new Date}},computed:Object(f["a"])({weekSchedule(){const e=Array(7).fill(null).map(()=>[]);return this.filteredLessons.forEach(t=>{const a=Object(n["getISODay"])(new Date(t.startDate))-1;e[a].push(t)}),e}},Object(b["c"])(["currentWeekDays","filteredLessons"])),methods:{isToday:n["isToday"]}},me=ue,ve=(a("0f16"),Object(O["a"])(me,ee,te,!1,null,"0366674a",null)),he=ve.exports,pe={name:"App",components:{modal:M,selectors:R,controlPanel:Z,eventsGrid:he},computed:Object(f["a"])({},Object(b["e"])(["filters","currentWeekStartDay","soloColumnIndex"]),{paramsForSearchString(){return{filters:this.filters,date:{week:this.currentWeekStartDay,day:this.soloColumnIndex}}}}),watch:{paramsForSearchString(e){this.$frame.sendMessage("new-state",encodeURI(JSON.stringify(e))),window.history.pushState({},"",`?__sched_state=${encodeURI(JSON.stringify(e))}`)}},created(){this.loadDataForWeek()},mounted(){const e=window.location.href,t=new window.URL(e).searchParams,a=JSON.parse(t.get("__sched_state"));a&&a.filters&&this.updateFilters({filters:a.filters}),a&&a.date&&(this.setSoloColumnIndex({index:+a.date.day}),this.setWeekStart({startDay:new Date(a.date.week)}))},methods:Object(f["a"])({},Object(b["d"])(["updateFilters","setSoloColumnIndex","setWeekStart"]),Object(b["b"])(["loadDataForWeek"]))},fe=pe,be=(a("5c0b"),a("5c64"),Object(O["a"])(fe,h,p,!1,null,null,null)),Ce=be.exports,ge=(a("55dd"),a("1da1")),_e=a("9a4b"),ke=a("3f86"),we=a("4c60"),ye=a("450b");s["default"].use(b["a"]);const Oe={lessons:[],isDataLoaded:!1,soloColumnIndex:Object(n["getISODay"])(new Date)-1,currentWeekStartDay:Object(n["startOfWeek"])(new Date,{weekStartsOn:1}),isModalOpened:!1,modalData:{},paths:{teacher:["teacher","name"],direction:["direction"],type:["textType"],address:["room","affiliate_id"]},agePaths:{minAge:["baseLesson","minAge"],maxAge:["baseLesson","maxAge"],minClass:["baseLesson","minClass"],maxClass:["baseLesson","maxClass"]},ageSelections:[{title:"Дошкольники",value:{minAge:0,maxAge:7}},{title:"1-2 класс",value:{minClass:1,maxClass:2}},{title:"3-4 класс",value:{minClass:3,maxClass:4}},{title:"5-11 класс",value:{minClass:5,maxClass:11}}],maps:{address:{1:"Ул. Академика Анохина, 4к1",2:"Ул. Кременчугская, 13",3:"Ул. Олимпийская деревня, 23к1",4:"Ул. Народного ополчения, 9к5",5:"Ленинский пр-т, 2к4, МИСиС КБ 17",6:"Ул. Мосфильмовская, 88к5"}},filters:{age:[],teacher:[],type:[],direction:[],address:[]}},De=(e,t)=>{let a=t.startDay;e.currentWeekStartDay=a},je=(e,t)=>{let a=t.index;e.soloColumnIndex=a},xe={setSoloColumnIndex:je,setWeekStart:De,setLessons:(e,t)=>{e.lessons=t},setWeekToNext:e=>{const t=Object(n["addWeeks"])(e.currentWeekStartDay,1);De(e,{startDay:t})},setWeekToPrevious:e=>{const t=Object(n["subWeeks"])(e.currentWeekStartDay,1);De(e,{startDay:t})},setWeekToCurrent:e=>{const t=Object(n["startOfWeek"])(new Date,{weekStartsOn:1}),a=Object(n["getISODay"])(new Date)-1;je(e,{index:a}),De(e,{startDay:t})},updateFilter:(e,t)=>{let a=t.category,s=t.selection;e.filters[a]=s,e.filters=Object(f["a"])({},e.filters,{[a]:s})},updateFilters:(e,t)=>{let a=t.filters;e.filters=a},setLoadedStatus:(e,t)=>{let a=t.isLoaded;e.isDataLoaded=a},setModalStatus:(e,t)=>{let a=t.isOpened;e.isModalOpened=a},setModalData:(e,t)=>{let a=t.data;e.modalData=a}},Se={availableSelections:e=>{const t={};return t.teacher=We(e.lessons,e.paths.teacher).map(e=>({value:e,title:e})),t.direction=We(e.lessons,e.paths.direction).map(e=>({value:e,title:e})),t.type=We(e.lessons,e.paths.type).map(e=>({value:e,title:e})),t.address=We(e.lessons,e.paths.address).map(t=>({value:t,title:e.maps.address[t]})),t.age=e.ageSelections,t},selectors:(e,t)=>{const a=t.availableSelections;return[{name:"Преподаватель",selections:a.teacher,category:"teacher"},{name:"Адрес",selections:a.address,category:"address"},{name:"Тип занятия",selections:a.type,category:"type"},{name:"Направление",selections:a.direction,category:"direction"},{name:"Возраст",selections:a.age,category:"age"}]},currentWeekDays:e=>Object(n["eachDay"])(e.currentWeekStartDay,Object(n["endOfWeek"])(e.currentWeekStartDay,{weekStartsOn:1})),currentMonth:e=>{const t=e.currentWeekStartDay,a=Object(n["endOfWeek"])(e.currentWeekStartDay,{weekStartsOn:1}),s=Object(n["format"])(t,"MMMM",{locale:i.a}),r=Object(n["format"])(a,"MMMM",{locale:i.a}),o=t.getFullYear(),l=a.getFullYear(),c=s===r,d=o===l;return`\n      ${s} ${d?"":o} ${c?"":` - ${r}`} ${l}\n    `},lessonsForCurrentWeek:(e,t)=>{let a=t.currentWeekDays;return e.lessons.filter(e=>a.some(t=>Object(n["isSameDay"])(t,new Date(e.startDate))))},filteredLessons:(e,t)=>{let a=t.lessonsForCurrentWeek;return Object.keys(e.filters).forEach(t=>{e.filters[t].length&&(a="age"===t?a.filter(a=>$e(a,e,t)):a.filter(a=>Me(a,e,t)))}),a}},Fe={loadDataForWeek(e){var t=this;return Object(ge["a"])(function*(){let a=e.commit,s=e.state;a("setLoadedStatus",{isLoaded:!1});const r=Object(n["format"])(s.currentWeekStartDay,"DD-MM-YYYY"),i=yield fetch(`https://db2.gekkon-club.ru/api/calendar?from=${r}`);a("setLessons",yield i.json()),a("setLoadedStatus",{isLoaded:!0}),t._vm.$frame.sendHeight()})()},switchToCurrentWeek(e){let t=e.dispatch,a=e.commit;a("setWeekToCurrent"),t("loadDataForWeek")},switchToNextWeek(e){let t=e.dispatch,a=e.commit;a("setWeekToNext"),t("loadDataForWeek")},switchToPreviousWeek(e){let t=e.dispatch,a=e.commit;a("setWeekToPrevious"),t("loadDataForWeek")}};function We(e,t){const a=[];let s;return e.forEach(e=>{s=Object(ne["a"])(e,t),a.includes(s)||a.push(s)}),a}function Me(e,t,a){return t.filters[a].map(e=>e.value).includes(Object(ne["a"])(e,t.paths[a]))}function $e(e,t,a){const s=t.filters[a],n=s.map(t=>{const a=Object(_e["a"])(t.value),s=Object(ke["a"])(e.baseLesson,a).sort();if(!Object(E["a"])(s))return!1;s[1]+=1;const n=Object(we["a"])(t.value);return Object(ye["a"])(n[0],...s)||Object(ye["a"])(n[1],...s)});return Object(E["a"])(n)}var Te=new b["a"].Store({state:Oe,mutations:xe,actions:Fe,getters:Se});l["c"].add(c["i"],c["e"],c["d"],c["j"],c["g"],c["h"],d["b"],c["f"],c["c"],c["a"],c["b"],d["a"]),s["default"].component("font-awesome-icon",u["a"]),s["default"].use(o["b"]),o["a"].localize("ru"),s["default"].prototype.$frame=new v.a.Child,s["default"].filter("formatDate",(e,t)=>Object(n["format"])(e,t,{locale:i.a})),s["default"].config.productionTip=!1,new s["default"]({render:e=>e(Ce),store:Te}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var s=a("5e27"),n=a.n(s);n.a},"5c64":function(e,t,a){"use strict";var s=a("c2ae"),n=a.n(s);n.a},"5e27":function(e,t,a){},"6add":function(e,t,a){},"6eeb":function(e,t,a){"use strict";var s=a("0381"),n=a.n(s);n.a},"77b3":function(e,t,a){},8462:function(e,t,a){"use strict";var s=a("af64"),n=a.n(s);n.a},"90a7":function(e,t,a){},"96f9":function(e,t,a){"use strict";var s=a("b40e"),n=a.n(s);n.a},af64:function(e,t,a){},b40e:function(e,t,a){},b4d8:function(e,t,a){"use strict";var s=a("c0f7"),n=a.n(s);n.a},c0f7:function(e,t,a){},c2ae:function(e,t,a){},d700:function(e,t,a){},f795:function(e,t,a){"use strict";var s=a("90a7"),n=a.n(s);n.a}});
//# sourceMappingURL=app.a7fbc838.js.map